# SV002: Managed Non-Table Not Customized

## Rule Description

Managed non-table components should only be included in a solution if they have been customized.

## Severity

**Warning** - This should be reviewed and cleaned up when possible.

## Why This Matters

Including unmodified managed components in your solution serves no purpose and causes several issues:

### 1. Solution Bloat
Unmodified managed components don't add any value to your solution but increase its size, making it:
- Slower to export
- Slower to import
- Harder to review and understand
- More complex to maintain

### 2. False Dependencies
Including components you haven't modified creates unnecessary dependencies that:
- Make it harder to determine what your solution actually does
- Can prevent you from removing the base managed solution if needed
- Complicate dependency analysis

### 3. Upgrade Complications
When the base managed solution is upgraded:
- Your solution may conflict with the upgrade
- You may need to update your solution even though you haven't actually customized anything
- Import operations become more complex and error-prone

### 4. Maintenance Confusion
Other developers or administrators looking at your solution will see these components and assume they've been customized for a reason, wasting time investigating unnecessary components.

## What Components Does This Apply To?

This rule checks non-table root components such as:
- **Web Resources** that haven't been modified
- **Workflows/Cloud Flows** that are from managed solutions but unchanged
- **Plugins** from managed solutions that haven't been customized
- **Forms** from managed tables that haven't been modified (when added as root components)
- **Views** from managed tables that haven't been modified (when added as root components)
- Other managed components that haven't been customized

## How to Fix

Review each flagged component and determine if it's actually needed:

### 1. Remove Unmodified Components
If the component hasn't been customized:
```powershell
Remove-DataverseSolutionComponent -Connection $conn -SolutionName MySolution `
    -ComponentType $componentType -ComponentId $componentId
```

### 2. Verify Customization Status
Check if the component is truly customized:
```powershell
# Get component details
Get-DataverseSolutionComponent -Connection $conn -SolutionName MySolution | 
    Where-Object { $_.IsCustomized -eq $false -and $_.IsManaged -eq $true }
```

### 3. Document Intentional Inclusions
If you have a valid reason to include an unmodified managed component:
- Document why in your solution documentation
- Consider if there's an alternative approach
- Be prepared to maintain this choice as the base solution evolves

## Example Scenario

You have a solution that includes:
- A custom web resource you created
- A workflow from a managed solution that you haven't modified
- A form from a managed entity that you haven't modified

**Problem:**
```powershell
# Your solution incorrectly includes unmodified managed components
Get-DataverseSolutionComponent -Connection $conn -SolutionName MySolution

# Output shows:
# - CustomWebResource (custom) ✓ Correct
# - ManagedWorkflow (managed, not customized) ✗ Should be removed
# - ManagedForm (managed, not customized) ✗ Should be removed
```

**Solution:**
```powershell
# Remove the unmodified managed components
Remove-DataverseSolutionComponent -Connection $conn -SolutionName MySolution `
    -ComponentType 29 -ComponentId $managedWorkflowId

Remove-DataverseSolutionComponent -Connection $conn -SolutionName MySolution `
    -ComponentType 60 -ComponentId $managedFormId

# Your solution now only contains what you've actually created or customized
```

## Exceptions

There are rare cases where you might intentionally include an unmodified managed component:
- **Documentation/Reference**: Including components to document dependencies (though this is better done with solution dependencies)
- **Patching Scenarios**: Creating patches that reference but don't modify components

In these cases, be aware of the trade-offs and document your reasoning.

## Related Documentation

- [Managed properties in Dataverse](https://learn.microsoft.com/en-us/power-platform/alm/managed-properties-alm)
- [Solution concepts and best practices](https://learn.microsoft.com/en-us/power-platform/alm/solution-concepts-alm)

## See Also

- [SV001: Managed Table Include Subcomponents](SV001.md)
- [SV003: Managed Subcomponent Not Customized](SV003.md)
