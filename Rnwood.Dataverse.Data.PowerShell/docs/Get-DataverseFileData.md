---
external help file: Rnwood.Dataverse.Data.PowerShell.Cmdlets.dll-Help.xml
Module Name: Rnwood.Dataverse.Data.PowerShell
online version:
schema: 2.0.0
---

# Get-DataverseFileData

## SYNOPSIS
Downloads file data from a Dataverse file column.

## SYNTAX

### FilePath
```
Get-DataverseFileData -TableName <String> -Id <Guid> -ColumnName <String> -FilePath <String>
 [-BlockSize <Int32>] [-Connection <ServiceClient>] [-ProgressAction <ActionPreference>] [<CommonParameters>]
```

### Folder
```
Get-DataverseFileData -TableName <String> -Id <Guid> -ColumnName <String> -FolderPath <String>
 [-BlockSize <Int32>] [-Connection <ServiceClient>] [-ProgressAction <ActionPreference>] [<CommonParameters>]
```

### Bytes
```
Get-DataverseFileData -TableName <String> -Id <Guid> -ColumnName <String> [-AsBytes] [-BlockSize <Int32>]
 [-Connection <ServiceClient>] [-ProgressAction <ActionPreference>] [<CommonParameters>]
```

## DESCRIPTION
The Get-DataverseFileData cmdlet downloads file data from a Dataverse file column. You can download to a specific file path, to a folder (using the original filename), or retrieve the file content as a byte array for processing in memory.

## EXAMPLES

### Example 1: Download file to specific path
```powershell
PS C:\> Get-DataverseConnection -Url https://myorg.crm.dynamics.com -Interactive -SetAsDefault
PS C:\> Get-DataverseFileData -TableName "account" -Id $accountId -ColumnName "documentfile" -FilePath "C:\Downloads\contract.pdf"
```

Downloads the file from the specified column to the given file path.

### Example 2: Download file to folder with original filename
```powershell
PS C:\> Get-DataverseConnection -Url https://myorg.crm.dynamics.com -Interactive -SetAsDefault
PS C:\> Get-DataverseFileData -TableName "account" -Id $accountId -ColumnName "documentfile" -FolderPath "C:\Downloads"
```

Downloads the file using its original filename into the specified folder.

### Example 3: Get file content as byte array
```powershell
PS C:\> Get-DataverseConnection -Url https://myorg.crm.dynamics.com -Interactive -SetAsDefault
PS C:\> $bytes = Get-DataverseFileData -TableName "account" -Id $accountId -ColumnName "documentfile" -AsBytes
```

Retrieves the file content as a byte array for in-memory processing.

### Example 4: Pipe from Get-DataverseRecord
```powershell
PS C:\> Get-DataverseConnection -Url https://myorg.crm.dynamics.com -Interactive -SetAsDefault
PS C:\> Get-DataverseRecord -TableName "account" -Id $accountId | Get-DataverseFileData -ColumnName "documentfile" -FolderPath "C:\Downloads"
```

Pipes a record from Get-DataverseRecord and downloads its file.

## PARAMETERS

### -AsBytes
Return the file content as a byte array

```yaml
Type: SwitchParameter
Parameter Sets: Bytes
Aliases:

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -BlockSize
Block size for downloading files in bytes. Default is 4MB (4194304 bytes)

```yaml
Type: Int32
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: 4194304
Accept pipeline input: False
Accept wildcard characters: False
```

### -ColumnName
Logical name of the file column

```yaml
Type: String
Parameter Sets: (All)
Aliases:

Required: True
Position: Named
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: False
```

### -Connection
DataverseConnection instance obtained from Get-DataverseConnection cmdlet.
If not provided, uses the default connection set via Get-DataverseConnection -SetAsDefault.

```yaml
Type: ServiceClient
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -FilePath
File path where the file will be saved

```yaml
Type: String
Parameter Sets: FilePath
Aliases:

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -FolderPath
Folder path where the file will be saved.
The filename will be taken from the file metadata

```yaml
Type: String
Parameter Sets: Folder
Aliases:

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -Id
ID of the record containing the file

```yaml
Type: Guid
Parameter Sets: (All)
Aliases:

Required: True
Position: Named
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: False
```

### -ProgressAction
Determines how PowerShell responds to progress updates generated by the cmdlet.

```yaml
Type: ActionPreference
Parameter Sets: (All)
Aliases: proga

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -TableName
Logical name of table containing the file column

```yaml
Type: String
Parameter Sets: (All)
Aliases: EntityName, LogicalName

Required: True
Position: Named
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: False
```

### CommonParameters
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see [about_CommonParameters](http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### System.String

### System.Guid

## OUTPUTS

### System.Byte[]

### System.IO.FileInfo

## NOTES

## RELATED LINKS
