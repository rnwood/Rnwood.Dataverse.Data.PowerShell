# <auto-generated>
#     This code was generated by GenerateRequestCmdlets.ps1 (version 1.0.0) on 2025-10-08T20:30:08.5188662+00:00.
#     Changes to this file may cause incorrect behavior and will be lost if the code is regenerated.
# </auto-generated>

. $PSScriptRoot/../Common.ps1

Describe 'Invoke-DataverseImportSolutionAsync' {

    BeforeAll {
        $script:conn = getMockConnection
    }

    It 'Can invoke the cmdlet with a mock connection' {
        {
            # Create test parameters
            $OverwriteUnmanagedCustomizations = $true
            $PublishWorkflows = $true
            $ImportJobId = [Guid]::NewGuid()
            $ConvertToManaged = $true
            $SkipProductUpdateDependencies = $true
            $HoldingSolution = $true
            $SkipQueueRibbonJob = $true
            $AsyncRibbonProcessing = $true
            $IsTemplateMode = $true
            $TemplateSuffix = "TestTemplateSuffix"
            $TemplateDisplayNamePrefix = "TestTemplateDisplayNamePrefix"

            $result = Invoke-DataverseImportSolutionAsync -Connection $script:conn -OverwriteUnmanagedCustomizations $OverwriteUnmanagedCustomizations -PublishWorkflows $PublishWorkflows -ImportJobId $ImportJobId -ConvertToManaged $ConvertToManaged -SkipProductUpdateDependencies $SkipProductUpdateDependencies -HoldingSolution $HoldingSolution -SkipQueueRibbonJob $SkipQueueRibbonJob -AsyncRibbonProcessing $AsyncRibbonProcessing -ComponentParameters $ComponentParameters -IsTemplateMode $IsTemplateMode -TemplateSuffix $TemplateSuffix -TemplateDisplayNamePrefix $TemplateDisplayNamePrefix
            $result | Should -Not -BeNull
        } | Should -Not -Throw
    }

    It 'Supports -WhatIf parameter' {
        {
            # Basic WhatIf test - may need parameter adjustment
            $result = Invoke-DataverseImportSolutionAsync -Connection $script:conn -WhatIf
        } | Should -Not -Throw
    }
}
